<?xml version="1.0" encoding="utf-8"?>
<project name="ExpenseRequestStarterApp" default="deploy" basedir="C:\Users\Mohammad.Murshed\Documents\GitHub\WorkflowCommons\Source">
  <description>Ant buildfile for deployment. Generated by Mendix Studio Pro.</description>
  <property name="deployment" location="deployment" />
  <property name="model" location="${deployment}/model" />
  <target name="clean" description="clean the deployment directory">
    <delete dir="${model}" />
    <delete dir="${deployment}/run" />
  </target>
  <target name="clean-custom-classes" description="clean the compiled custom java action classes">
    <delete>
      <fileset dir="${deployment}/run/bin" includes="**/*" />
    </delete>
  </target>
  <target name="clean-excluded-jars" description="clean the jar files that should be excluded" />
  <target name="deploy" description="deploy the project">
    <copy todir="${deployment}" overwrite="true">
      <fileset dir="C:/Program Files/Mendix/10.0.0.9976/modeler/runtemplates/deployment">
        <exclude name="**/*.template" />
      </fileset>
    </copy>
    <copy todir="${model}/lib/userlib" overwrite="true">
      <fileset dir="userlib" />
    </copy>
    <copy todir="${model}/resources" overwrite="true">
      <fileset dir="resources" />
    </copy>
  </target>
  <target name="compile" description="Compile Java actions">
    <javac destdir="${deployment}/run/bin" includeAntRuntime="false" debug="true" debuglevel="lines,source" encoding="UTF-8">
      <src path="javasource" />
      <classpath>
        <fileset file="C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.json.jar" />
        <fileset file="C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.logging-api.jar" />
        <fileset file="C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.m2ee-api.jar" />
        <fileset file="C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.public-api.jar" />
        <fileset file="C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/javax.servlet.servlet-api.jar" />
        <fileset file="C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/javax.websocket.websocket-api.jar" />
        <fileset dir="userlib">
          <include name="*.jar" />
        </fileset>
      </classpath>
    </javac>
  </target>
  <target name="checkDependencies" description="Check dependencies">
    <tempfile property="jdeps.outputlog" destdir="${java.io.tmpdir}" createfile="true" deleteonexit="true" />
    <exec executable="java" output="${jdeps.outputlog}">
      <arg value="-Duser.language=en" />
      <arg value="com.sun.tools.jdeps.Main" />
      <arg value="-cp" />
      <arg value="C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.json.jar${path.separator}C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.logging-api.jar${path.separator}C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.m2ee-api.jar${path.separator}C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/com.mendix.public-api.jar${path.separator}C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/javax.servlet.servlet-api.jar${path.separator}C:/Program Files/Mendix/10.0.0.9976/runtime/bundles/javax.websocket.websocket-api.jar${path.separator}userlib/.*" />
      <arg value="--multi-release" />
      <arg value="11" />
      <arg value="-verbose:class" />
      <arg value="-p" />
      <arg value="javax.activation" />
      <arg value="-p" />
      <arg value="javax.activity" />
      <arg value="-p" />
      <arg value="javax.annotation" />
      <arg value="-p" />
      <arg value="javax.jws.soap" />
      <arg value="-p" />
      <arg value="javax.jws" />
      <arg value="-p" />
      <arg value="javax.transaction" />
      <arg value="-p" />
      <arg value="javax.rmi.CORBA" />
      <arg value="-p" />
      <arg value="javax.rmi" />
      <arg value="-p" />
      <arg value="javax.xml.bind.annotation.adapters" />
      <arg value="-p" />
      <arg value="javax.xml.bind.annotation" />
      <arg value="-p" />
      <arg value="javax.xml.bind.attachment" />
      <arg value="-p" />
      <arg value="javax.xml.bind.helpers" />
      <arg value="-p" />
      <arg value="javax.xml.bind.util" />
      <arg value="-p" />
      <arg value="javax.xml.bind" />
      <arg value="-p" />
      <arg value="javax.xml.soap" />
      <arg value="-p" />
      <arg value="javax.xml.ws.handler.soap" />
      <arg value="-p" />
      <arg value="javax.xml.ws.handler" />
      <arg value="-p" />
      <arg value="javax.xml.ws.http" />
      <arg value="-p" />
      <arg value="javax.xml.ws.soap" />
      <arg value="-p" />
      <arg value="javax.xml.ws.spi.http" />
      <arg value="-p" />
      <arg value="javax.xml.ws.spi" />
      <arg value="-p" />
      <arg value="javax.xml.ws.wsaddressing" />
      <arg value="-p" />
      <arg value="javax.xml.ws" />
      <arg value="-p" />
      <arg value="org.omg.CORBA" />
      <arg value="-p" />
      <arg value="org.omg.CORBA_2_3" />
      <arg value="-p" />
      <arg value="org.omg.CORBA_2_3.portable" />
      <arg value="-p" />
      <arg value="org.omg.CORBA.DynAnyPackage" />
      <arg value="-p" />
      <arg value="org.omg.CORBA.ORBPackage" />
      <arg value="-p" />
      <arg value="org.omg.CORBA.portable" />
      <arg value="-p" />
      <arg value="org.omg.CORBA.TypeCodePackage" />
      <arg value="-p" />
      <arg value="org.omg.CosNaming" />
      <arg value="-p" />
      <arg value="org.omg.CosNaming.NamingContextExtPackage" />
      <arg value="-p" />
      <arg value="org.omg.CosNaming.NamingContextPackage" />
      <arg value="-p" />
      <arg value="org.omg.Dynamic" />
      <arg value="-p" />
      <arg value="org.omg.DynamicAny" />
      <arg value="-p" />
      <arg value="org.omg.DynamicAny.DynAnyFactoryPackage" />
      <arg value="-p" />
      <arg value="org.omg.DynamicAny.DynAnyPackage" />
      <arg value="-p" />
      <arg value="org.omg.IOP" />
      <arg value="-p" />
      <arg value="org.omg.IOP.CodecFactoryPackage" />
      <arg value="-p" />
      <arg value="org.omg.IOP.CodecPackage" />
      <arg value="-p" />
      <arg value="org.omg.Messaging" />
      <arg value="-p" />
      <arg value="org.omg.PortableInterceptor" />
      <arg value="-p" />
      <arg value="org.omg.PortableInterceptor.ORBInitInfoPackage" />
      <arg value="-p" />
      <arg value="org.omg.PortableServer" />
      <arg value="-p" />
      <arg value="org.omg.PortableServer.CurrentPackage" />
      <arg value="-p" />
      <arg value="org.omg.PortableServer.POAManagerPackage" />
      <arg value="-p" />
      <arg value="org.omg.PortableServer.POAPackage" />
      <arg value="-p" />
      <arg value="org.omg.PortableServer.portable" />
      <arg value="-p" />
      <arg value="org.omg.PortableServer.ServantLocatorPackage" />
      <arg value="-p" />
      <arg value="org.omg.SendingContext" />
      <arg value="-p" />
      <arg value="org.omg.stub.java.rmi" />
      <arg value="${deployment}/run/bin" />
    </exec>
    <loadfile srcfile="${jdeps.outputlog}" property="jdeps.output">
      <filterchain>
        <linecontains negate="true">
          <contains value="Warning: " />
        </linecontains>
      </filterchain>
    </loadfile>
    <condition property="jdeps.hasErrors">
      <contains string="${jdeps.output}" substring="not found" casesensitive="false" />
    </condition>
    <echo xmlns:if="ant:if" if:true="${jdeps.hasErrors}" message="${jdeps.output}" />
    <fail if="${jdeps.hasErrors}" message="Dependency checked failed, most probably some packages and/or classes are not provided." />
  </target>
  <target name="package" description="Generate Jar File">
    <jar destfile="${deployment}/model/bundles/project.jar">
      <fileset dir="${deployment}/run/bin" excludes=".keep" />
      <fileset dir="userlib" excludes="**/*.jar" casesensitive="false" />
      <zipfileset dir="${deployment}/run" includes="component.xml" fullpath="OSGI-INF/component.xml" />
      <manifest>
        <attribute name="Bundle-Name" value="Source" />
        <attribute name="Bundle-SymbolicName" value="project" />
        <attribute name="Service-Component" value="OSGI-INF/component.xml" />
      </manifest>
    </jar>
  </target>
</project>